# lab-riscv-asm
## Вариант задания

Вариант задания: Найти значение минимального элемента массива. (N = 5, M = 4)

## Результаты работы

* **example.S** - программа на RISC-V ASM
* **example.c** - программа на Си
* **example.dump** - дамп-файл программы на Си

## Программа на Си

В данной програме в функции "main" осуществляется инициализация массива и считывание из консоли элементов массива.

Далее вызывается функция "process", которая осуществляет поиск минимального элемента массива. Начальным значением для поиска минимального
значения является первый элемент массива. В функции присутствует цикл, осуществляющий перебор каждого элемента массива. Если какой-то элемент
меньше текущего минимального значения, то он становится новым минимальным значением.

Возвращаемое функцией значение записывается в переменную "result" и выводится в консоль.

## Программа на RISC-V ASM

В данной программе сначала производится инициализация перемнных, хранящих размерность массива, и самого массива.

В функции "main" производится чтение из памяти данных в регистры общего назначения a2-a4 указателей на переменные, хранящие размерность массива,
и первый элемент массива. Регистры a2-a4, в соответствии с RISC-V ABI, хранят аргументы функции. Далее вызываются функции "process", "print",
"exit". Вызов функций осуществляется с помощью псевдоинструкции call (обертка над jal), осуществляющей безусловное ветвление по адресу функции, и запсывающей
в регистр ra адрес следующей за call инструкции.

Функция "process" осущетслвяет поиск минимального элемента массива. Сначала производится чтение из памяти переменных, хранящих размерность массива,
и первого элемента массива в регистры t1-t3, храянщие временные переменные. Далее инициализируются переменные, хранящие номер текущего элемента массива.
Данные переменные хранятся в регистрах t4-t5 и используются в инструкциях ветвления, которые представляют собой низкоуровневую интерпретацию
циклов "for" из программы на Си. Для чтения из памяти элементов массива используется указатель, хранящийся в регистре a4. Так как массив хранится в памяти
последовательно, для перемещения по элементам указатель инкрементируется на 4 байта после каждого чтения. В конце тела функции найденное минимальное
значение записывается в регистр a1, хранящий возвращаемые функциями значения. Далее следует псевдоинстуркция ret (обертка над инструкцией jalr),
осуществляющая безусловный переход по адресу возврата функции, хранящемуся в регистре ra.

В функции "print" осуществляется вывод в консоль полученного минимального элемента массива. Для вывода используются системные вызовы симулятора Venus.
Для вывода в консоль целого числа используется системный вызов "print_int". Для его использования необходимо в регистр a1 записать выводимое
значение (оно уже там, поскольку функция "process" использовала данный регистр для возврата полученного значения), в регистр a0 записать ID системного вызова, в 
данном случае 1, а потом выполнить CSR инструкцию ecall. Далее в консоль выводится символ возврата каретки с помощью системного вызова
"print_character", выводящего в консоль символ ASCII. Принцип использования аналогичен "print_int". В регистр a1 записывается кодировка символа
(0x0D), а в регистр a0 ID=11. Далее осуществляется возврат в функцию "main" с помощью инструкции ret.

В функции "exit" осуществляется выполнение системного вызова "exit", сигнализирующего о конце программы. Для этого в регистр a0 записывается ID=10.

Используемые начальные данные:

![image](https://github.com/lokki11199/lab-riscv-asm/assets/131533616/31cae597-f218-4b4f-8904-f7d5bae87330)

Результат выполнения:

![image](https://github.com/lokki11199/lab-riscv-asm/assets/131533616/b3d3b606-88a7-4ee8-93d3-057ecc0007f4)

